<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SWM - Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø§Ù„ÙŠ v1.2.18</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@300;400;500;700&family=JetBrains+Mono:wght@400;600&display=swap"
        rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="style.css?v=1.2.9">
    <style>
        /* Specific Styles for Analysis Page */
        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            padding: 20px;
            height: calc(100vh - 50px);
            overflow-y: auto;
        }

        .card {
            background: var(--panel-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 16px;
            display: flex;
            flex-direction: column;
        }

        .card-header {
            font-size: 16px;
            font-weight: bold;
            color: var(--text-muted);
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .stock-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .stock-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            font-size: 14px;
        }

        .stock-item:last-child {
            border-bottom: none;
        }

        .stock-name {
            color: var(--text-main);
        }

        .stock-price {
            font-family: 'JetBrains Mono', monospace;
        }

        .val-up {
            color: var(--up-color);
        }

        .val-down {
            color: var(--down-color);
        }

        /* Filter Buttons Grid */
        .filter-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            padding: 20px 20px 10px 20px;
        }

        .filter-btn {
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            color: #ccc;
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 10px 20px;
            border-radius: 8px;
            /* Rectangular with slight roundness */
            cursor: pointer;
            font-family: inherit;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .filter-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
            color: #fff;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
        }

        .filter-btn.active {
            background: rgba(56, 189, 248, 0.15);
            /* Semi-transparent accent */
            color: var(--text-accent) !important;
            font-weight: bold;
            border: 1px solid var(--text-accent);
            box-shadow: 0 0 15px rgba(56, 189, 248, 0.2);
        }
    </style>

    <!-- Lightweight Charts -->
    <script src="https://unpkg.com/lightweight-charts@4.1.1/dist/lightweight-charts.standalone.production.js"></script>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
</head>

<body>

    <div class="app-shell">
        <!-- Top Navigation -->
        <header class="terminal-header">
            <div class="brand">
                <span class="brand-icon">âš¡</span>
                <div style="display: flex; flex-direction: column;">
                    <span style="line-height: 1;">Ø§Ù„Ù…ØªØ¯Ø§ÙˆÙ„</span>
                    <span style="font-size: 10px; opacity: 0.6; font-family: monospace;">v1.2.18</span>
                </div>
            </div>

            <nav class="main-nav" style="margin-left: auto; margin-right: 20px; display: flex; gap: 15px;">
                <a href="index.html" style="color: #fff; text-decoration: none; opacity: 0.8;">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
                <a href="news.html" style="color: #fff; text-decoration: none; opacity: 0.8;">Ø§Ù„Ø£Ø®Ø¨Ø§Ø±</a>
                <a href="#"
                    style="color: #fff; text-decoration: none; opacity: 0.8; font-weight: bold; border-bottom: 2px solid var(--text-accent);">Ø§Ù„ØªØ­Ù„ÙŠÙ„</a>
                <a href="donchian.html" style="color: #fff; text-decoration: none; opacity: 0.8;">Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø¯ÙˆÙ†Ø´ÙŠØ§Ù†</a>
            </nav>

            <div class="market-status">
                <div class="stat-item" id="tasi-summary">
                    <span class="stat-label">TASI</span>
                    <span class="stat-value up" id="header-tasi-price">---</span>
                    <span class="stat-value up" id="header-tasi-change">---</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Status</span>
                    <span class="stat-value" style="color: var(--up-color)">â— Connected</span>
                </div>
            </div>
        </header>

        <!-- Filter Buttons -->
        <div class="filter-grid" id="filter-buttons">
            <button class="filter-btn active" data-mode="gainers">Ø§Ù„Ø£ÙƒØ«Ø± Ø§Ø±ØªÙØ§Ø¹Ø§Ù‹ ğŸš€</button>
            <button class="filter-btn" data-mode="losers">Ø§Ù„Ø£ÙƒØ«Ø± Ø§Ù†Ø®ÙØ§Ø¶Ø§Ù‹ ğŸ”»</button>
            <button class="filter-btn" data-mode="volume">Ø§Ù„Ø£Ø¹Ù„Ù‰ Ø³ÙŠÙˆÙ„Ø© ğŸ’°</button>
            <button class="filter-btn" data-mode="breakout">Ø§Ø®ØªØ±Ø§Ù‚ Ù‚ÙˆÙŠ (Ø³ÙŠÙˆÙ„Ø©) ğŸ’¥</button>
            <button class="filter-btn" data-mode="speculative">ÙØ±Øµ Ù…Ø¶Ø§Ø±Ø¨ÙŠØ© (Ø°Ù‡Ø¨ÙŠØ©) âœ¨</button>
            <button class="filter-btn" data-mode="reversal">Ø¨Ø¯Ø§ÙŠØ© Ø§Ù†Ø¹ÙƒØ§Ø³ Ø¥ÙŠØ¬Ø§Ø¨ÙŠ ğŸ”„</button>
            <button class="filter-btn" data-mode="morning_star">Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØµØ¨Ø§Ø­ (Ø§Ø±ØªØ¯Ø§Ø¯) ğŸŒ…</button>
            <button class="filter-btn" data-mode="donchian_breakout">Ø§Ø®ØªØ±Ø§Ù‚ Ù‚Ù†Ø§Ø© Ø¯ÙˆÙ†Ø´ÙŠØ§Ù† ğŸ“ˆ</button>
            <button class="filter-btn" data-mode="vwap_bounce">Ø§Ø±ØªÙƒØ§Ø² VWAP ğŸ¯</button>
            <button class="filter-btn" data-mode="bullish_div">Ø¯Ø§ÙŠÙØ±Ø¬Ù†Ø³ Ø¥ÙŠØ¬Ø§Ø¨ÙŠ ğŸŸ¢</button>
            <button class="filter-btn" data-mode="overbought">ØªØ¶Ø®Ù… Ø´Ø±Ø§Ø¦ÙŠ (Ø­Ø°Ø±) âš ï¸</button>
        </div>

        <!-- Analysis Dashboard -->
        <main class="analysis-container"
            style="padding: 0 20px 20px 20px; display: flex; gap: 20px; height: calc(100vh - 160px);">

            <!-- Table Section (40%) -->
            <div class="card" style="flex: 0 0 400px; display: flex; flex-direction: column; overflow: hidden;">
                <!-- Strategy Info & Stats -->
                <div id="strategyInfo"
                    style="display:none; background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 1px solid rgba(255,255,255,0.1);">
                    <div
                        style="display: flex; justify-content: space-between; align-items: flex-start; flex-wrap: wrap; gap: 10px;">
                        <div style="flex: 1; min-width: 150px;">
                            <h3 id="strategyTitle" style="margin: 0 0 8px 0; color: #4caf50; font-size: 1rem;"></h3>
                            <p id="strategyDesc" style="margin: 0; color: #ccc; font-size: 0.85rem; line-height: 1.4;">
                            </p>
                        </div>
                        <div
                            style="text-align: left; min-width: 120px; background: rgba(0,0,0,0.2); padding: 8px; border-radius: 6px;">
                            <div style="font-size: 0.75rem; color: #888;">Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: <span id="lastUpdate"
                                    style="color: #fff;">-</span></div>
                            <div style="margin-top: 4px; font-size: 0.8rem;">
                                <span style="color: #4caf50;">âœ” <span id="matchCount">0</span></span> |
                                <span style="color: #666;">âŒ <span id="unmatchCount">0</span></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="table-wrapper" style="flex: 1; overflow-y: auto;">
                    <table class="data-table" style="width: 100%; border-collapse: collapse; font-size: 13px;">
                        <thead style="position: sticky; top: 0; background: var(--panel-bg); z-index: 1;">
                            <tr>
                                <th
                                    style="padding: 8px; text-align: right; border-bottom: 1px solid var(--border-color); color: var(--text-muted); font-weight: 500;">
                                    Ø§Ù„Ø´Ø±ÙƒØ©</th>
                                <th
                                    style="padding: 8px; text-align: left; border-bottom: 1px solid var(--border-color); color: var(--text-muted); font-weight: 500;">
                                    Ø¢Ø®Ø± Ø³Ø¹Ø±</th>
                                <th
                                    style="padding: 8px; text-align: left; border-bottom: 1px solid var(--border-color); color: var(--text-muted); font-weight: 500;">
                                    Ø§Ù„ØªØºÙŠØ± %</th>
                                <th
                                    style="padding: 8px; text-align: left; border-bottom: 1px solid var(--border-color); color: var(--text-muted); font-weight: 500;">
                                    Ù‚ÙŠÙ…Ø© Ø§Ù„ØªØºÙŠØ±</th>
                            </tr>
                        </thead>
                        <tbody id="analysis-table-body">
                            <!-- Rows injected here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Chart Section (Remaining) -->
            <div class="card" id="chart-card"
                style="flex: 1; display: flex; flex-direction: column; opacity: 0.5; pointer-events: none; position: relative;">
                <div
                    style="padding-bottom: 10px; border-bottom: 1px solid var(--border-color); margin-bottom: 10px; display: flex; justify-content: space-between;">
                    <span id="chart-title" style="font-weight: bold; color: var(--text-accent);">Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ</span>
                    <span id="chart-status" style="font-size: 12px; color: #888;">Ø§Ø®ØªØ± Ø´Ø±ÙƒØ© Ù„Ù„Ø¹Ø±Ø¶</span>
                </div>
                <div id="strategy-chart" style="flex: 1; width: 100%;"></div>

                <!-- Overlay message -->
                <div id="chart-overlay"
                    style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; flex-direction: column; background: rgba(0,0,0,0.5); backdrop-filter: blur(2px); z-index: 10;">
                    <div style="font-size: 40px; margin-bottom: 10px;">ğŸ‘ˆ</div>
                    <div style="color: #fff;">Ø§Ø®ØªØ± Ø´Ø±ÙƒØ© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ</div>
                </div>
            </div>

        </main>
    </div>

    <!-- Logic -->
    <script src="chart_utils.js?v=1.0.0"></script>
    <script src="analysis.js?v=1.2.18"></script>
</body>

</html>